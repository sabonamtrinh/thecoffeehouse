//
//  Extensions.swift
//  TheCoffeeHouse
//
//  Created by namtrinh on 9/14/20.
//  Copyright Â© 2020 namtrinh. All rights reserved.
//

import UIKit

extension UIView {
    public var width: CGFloat {
        return frame.size.width
    }
    public var height: CGFloat {
        return frame.size.height
    }
    public var top: CGFloat {
        return frame.origin.y
    }
    public var bottom: CGFloat {
        return frame.origin.y + frame.size.height
    }
    public var left: CGFloat {
        return frame.origin.x
    }
    public var right: CGFloat {
        return frame.origin.x + frame.size.width
    }
    
    func addConstraintsWithFormat(format: String, views: UIView...) {
        var viewsDictionary = [String: UIView]()
        for (index,view) in views.enumerated() {
            let key = "v\(index)"
            viewsDictionary[key] = view
        }
        addConstraints(NSLayoutConstraint.constraints(withVisualFormat: format, options: NSLayoutConstraint.FormatOptions(), metrics: nil, views: viewsDictionary))
    }
    
}

extension UIView {

    func startRotating(duration: CFTimeInterval = 7, repeatCount: Float = Float.infinity, clockwise: Bool = true) {

        if self.layer.animation(forKey: "transform.rotation.z") != nil {
            return
        }

        let animation = CABasicAnimation(keyPath: "transform.rotation.z")
        let direction = clockwise ? 1.0 : -1.0
        animation.toValue = NSNumber(value: .pi * 2 * direction)
        animation.duration = duration
        animation.isCumulative = true
        animation.repeatCount = repeatCount
        animation.isRemovedOnCompletion = false
        self.layer.add(animation, forKey:"transform.rotation.z")
        
    }

    func stopRotating() {

        self.layer.removeAnimation(forKey: "transform.rotation.z")

    }

}

extension String {
    func safeDatabaseKey() -> String {
        return self.replacingOccurrences(of: ".", with: "-").replacingOccurrences(of: "@", with: "-")
    }
}
